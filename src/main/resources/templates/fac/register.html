<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{layout/template}">
<head>
<meta charset="UTF-8" />
<title>설비정보등록</title>
<style>
. a {
   float: left;
   display: block;
   color: black;
   text-align: center;
   padding: 14px 16px;
   text-decoration: none;
   font-size: 17px;
}

. a:hover {
   background-color: #ddd;
   color: black;
}

 a.active {
   background-color: #2196F3;
   color: white;
}

.search-container {
   float: right;
}

.input[type=text] {
   padding: 6px;
   margin-top: 8px;
   font-size: 17px;
   border: none;
}

.search-container button {
   float: right;
   padding: 6px 10px;
   margin-top: 8px;
   margin-right: 16px;
   background: #ddd;
   font-size: 17px;
   border: none;
   cursor: pointer;
}

.search-container button:hover {
   background: #ccc;
}

@media screen and (max-width: 600px) {
    .search-container {
      float: none;
   }
 .input[type=text], .topnav .search-container button {
      float: none;
      display: block;
      text-align: left;
      width: 100%;
      margin: 0;
      padding: 14px;
   }
   .input[type=text] {
      border: 1px solid #ccc;
   }
   .fac_register{
        border: 1px solid black;   
        padding: 10px;
      }
      .btn{
        width: 5px 15px;
        background-color: #282cff;
        border: none;
        color: white;
        text-align: center;
        display: inline-block;
        font-size: 16px;
        float: right;
      }
   
}
</style>

 <script src="https://code.jquery.com/jquery-1.11.3.js"></script>
<link rel="stylesheet" href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css" />
<script src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.js"></script>
<link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
<script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script> <!-- 모달 -->
</head>

<body>
<!----------설비등록시작--------->
   <div layout:fragment="title">
     <h3>설비등록</h3>
     </div>

   <div layout:fragment="content">
      <form action="/fac/management" method="post">     
          <div class = "fac_register" style="text-align:left">
            
     
            <label for="fac_name">설비명</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="text" id="fac_name">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            
            <label for="fac_code">설비코드</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="text"id="fac_code" placeholder="EQMAN_자동생성" readonly>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            
            <label for="install_date">입고일자</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
            <input type="date">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
            
            <br>
            <label for="proc_name">공정명</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="text" id="proc_name" placeholder="조회 후 등록하시오">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            
            <label for="proc_code">공정코드</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="text" id="proc_code" readonly>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            
  
            <label for="confirm_cycle">점검주기(일)</label>&nbsp;&nbsp;
            <input type="text" id="confirm_cycle" size=11>
           
            
            <br>
            
            <label for="temp_min">최저온도(℃)</label>&nbsp;
            <input type="text" id="temp_min">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            
            <label for="temp_max">최고온도(℃)</label>&nbsp;&nbsp;
            <input type="text" id="temp_max">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            
              <label for="operate_check">가동여부</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="radio" name="operate_check" value="operate" checked>&nbsp;&nbsp;&nbsp;Y
            <input type="radio" name="operate_check" value="non_operate">&nbsp;&nbsp;&nbsp;N
            
            <br>
             <label for="maker_name">제조업체</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="text"id="maker_name">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

            <label for="emp_num">담당자</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="text" id="emp_num">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
           
             <br>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg"><i class="fa fa-search"></i></button>
           </div>

           </form>


            <h5 class="modal-title" >공정정보조회</h5>
            <label>공정명</label>
         <input class="modaltext" type=text id="ckproc-text">
        <button class="procsearchbtn" type="button" id="ckproc">검색</button>
            
            <div id="modal-grid2"></div>   
            <br>
            <div class="row">
               <div class="col">
                  <button class="w-30 btn btn-primary btn-lg" type="submit">등록</button>   
                  &nbsp;&nbsp;&nbsp;&nbsp;
                  <button class="w-30 btn btn-secondary btn-lg"type="reset">초기화</button>
               </div>
            </div>
            
<!--공정코드 모달 -->
<div class="modal fade bd-example-modal-lg" id="procCodemodalbtn" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
      <h5 class="modal-title" >공정코드조회</h5>
         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>      
      </div>
      <div class="modal-body" >
         <label>공정명</label>
         <input class="modaltext" type=text id="ckproc-text">
        <button class="procsearchbtn" type="button" id="ckproc">검색</button>
        
         <div id="modal-grid2"></div>
         
        <button class="submitprocmodalbtn" type="button" data-toggle="modal" data-target=".bd-example-modal-lg">선택</button>
 
      </div>
    </div>
  </div>
</div>
 
        
<!-- 설비정보목록그리드 -->
 <div id="grid"></div>
      
    <script>
    $(function(){
 
    //grid2-공정코드모달
      $.ajax({
         url : "/fac/proclistAjax",
         method : "GET",
         dataType : "JSON",
         success : function(result){
            grid2.resetData(result);
            grid2.refreshLayout();
         },
         error :function(reject){
        	 console.log(reject);
         }
      });
      
   var grid2 = new tui.Grid({
    el: document.getElementById('modal-grid2'),
    scrollX: false,
    scrollY: false,
    rowHeaders: ['rowNum'],
    columns: [
      {
        header: '공정명',
        name: 'procName'
      },
      {
        header: '공정코드',
        name: 'procCode'
      }
    ]
   })
   
   $(function(){  
    $('#procCodemodalbtn').on('shown.bs.modal', function(){ //공정코드모달버튼을 누르면 모달이 뜬다.
        grid2.refreshLayout(); 
       });
       })
   
   //공정코드모달검색조회
    $("#ckproc").on('click', function(){
       console.log($("#ckproc-text").val())
       const prsed = $("#ckproc-text").val()
      $("#ckproc-text").val('');
       
       $.ajax({
           url : "/fac/procminilist",   //공정코드목록조회 페이지 
            method : "GET",
            data : {'result' : prsed},
            success : function(result){
            grid2.resetData(result);
            grid2.refreshLayout();
            },
            error: function(reject){
               console.log(reject)
            }
  
    });
    });
   grid2.on('click', function(e){
      let content = grid2.getRow(e.rowKey); //grid2의 이벤트가 걸린 로우키가 내용
      $('#proc_code').val(content.procCode); //proc_code라는 id의 인풋 창에 값 rowKey안의 procCode를 넣음
      $('#proc_name').val(content.procName);//proc_name라는 id의 인풋 창에 값 rowKey안의 procName을 넣음
   })      
    })
   
     
 </script>
   </div>

</body>